<!DOCTYPE html>
<html>

<head>
  <title>基本资料</title>
  <!-- <meta charset="utf-8"> -->
  <!-- <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> -->
  <!-- Bootstrap -->
  <link href="bootstrap/css/bootstrap.css" rel="stylesheet" media="screen">
  <link href="bootstrap/css/bootstrap-responsive.css" rel="stylesheet" media="screen">
  <link href="assets/styles.css" rel="stylesheet" media="screen">

  <!-- <script src="vendors/modernizr-2.6.2-respond-1.1.0.min.js"></script> -->
</head>

<body>
  <div class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container-fluid">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"> <span class="icon-bar"></span>
         <span class="icon-bar"></span>
         <span class="icon-bar"></span>
       </a>
       <a class="brand" href="#">竞赛管理系统</a>
       <div class="nav-collapse collapse">
        <ul class="nav pull-right">
          <li class="dropdown">
            <a href="#" role="button" class="dropdown-toggle" data-toggle="dropdown"> <i class="icon-user"></i> 用户名称 <i class="caret"></i>

            </a>
            <ul class="dropdown-menu">
              <li>
                <a tabindex="-1" href="#">个人信息</a>
              </li>
              <li class="divider"></li>
              <li>
                <a tabindex="-1" href="login.html">退出</a>
              </li>
            </ul>
          </li>
        </ul>

      </div>
      <!--/.nav-collapse -->
    </div>
  </div>
</div>
<div class="container-fluid">
  <div class="row-fluid">
    <div class="span3" id="sidebar">
      <ul class="nav nav-list bs-docs-sidenav nav-collapse collapse">
        <li class="active">
          <a href="index.html"><i class="icon-chevron-right"></i> 基本资料</a>
        </li>
        <li>
          <a href="match_data.html"><i class="icon-chevron-right"></i> 比赛材料上传</a>
        </li>
        <li>
          <a href="expense.html"><i class="icon-chevron-right"></i> 报销信息</a>
        </li>
        
      </ul>
    </div>
    <!--/span-->
    <div class="span9" id="content">
      <!-- morris stacked chart -->
      <div class="row-fluid">
        <!-- block -->
        <div class="block">
          <div class="navbar navbar-inner block-header">
            <div class="muted pull-left">队伍资料</div>
          </div>
          <div class="block-content collapse in">
            <div class="span12">
             <form class="form-horizontal">
              <fieldset>
                <legend>队伍资料</legend>
                <div class="control-group">
                  <label class="control-label">联系人</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="contactName">耿方哲</span>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">联系人学号</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="contactStuID">1562410212</span>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">联系方式</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="contactTel">15989465465</span>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">联系邮箱</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="contactEmail">45654@qq.com</span>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">比赛</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="competition">中国软件杯</span>
                  </div>
                </div>
                <div class="control-group">
                  <label class="control-label">队伍名称</label>
                  <div class="controls">
                    <span class="input-xlarge uneditable-input" id="teamName">BlueBlueSky</span>
                  </div>
                </div>                            

              </fieldset>
            </form>
            <button class="btn btn-primary" onclick="change_team" id="change_team">修改队伍资料</button>
          </div>
        </div>
      </div>
      <!-- /block -->
    </div>

    <div class="row-fluid">
      <!-- block -->
      <div class="block">
        <div class="navbar navbar-inner block-header">
          <div class="muted pull-left">队员信息</div>
        </div>
        <div class="block-content collapse in">
          <legend>队员信息(第一人默认队长)</legend>
          <div class="table-responsive" style="margin-left:1%;overflow:scroll;">
            <table class="table table-hover" >
              <thead>
                <tr>
                  <th></th>
                  <th>姓名</th>
                  <th>专业</th>
                  <th>学号</th>
                  <th>身份证</th>
                  <th>联系方式</th>
                  <th>邮箱</th>
                  <th>状态</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody id="table_stu">
                
              </tbody>
            </table>
          </div>
          <button type="button" class="btn btn-primary" id="add_stu">添加队员</button>
        </div>
      </div>
      <!-- /block -->
    </div>



    <div class="row-fluid">
      <!-- block -->
      <div class="block">
        <div class="navbar navbar-inner block-header">
          <div class="muted pull-left">指导老师信息</div>
        </div>
        <div class="block-content collapse in">
          <legend>指导老师信息</legend>
          <div class="span12" style="overflow:scroll;">
            <table class="table table-hover" id="table_teacher">
              <thead>
                <tr>
                  <th></th>
                  <th>姓名</th>
                  <th>联系方式</th>
                  <th>邮箱</th>
                  <th>状态</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="id">1</td>
                  <td class="tea_name">马哲燚</td>
                  <td class="tea_tel">159945873321</td>
                  <td class="tea_id">1562412121@qq.com</td>
                  <td class="tea_state">通过</td>
                  <td>
                    <a href="change/change_teacher.html">修改</a>
                    <a href="javascript:void(0)" class="delete_teacher">删除</a>
                  </td>
                </tr>
                <tr>
                  <td class="id">2</td>
                  <td class="tea_name">耿元哲</td>
                  <td class="tea_tel">15994587921</td>
                  <td class="tea_id">1562312121@qq.com</td>
                  <td class="tea_state">通过</td>
                  <td>
                    <a href="change/change_teacher.html">修改</a>
                    <a href="javascript:void(0)" class="delete_teacher">删除</a>
                  </td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>Larry</td>
                  <td>the Bird</td>
                  <td>@twitter</td>
                  <td>@twitter</td>
                  <td>
                    <a href="change/change_teacher.html">修改</a>
                    <a href="javascript:void(0)" class="delete_teacher">删除</a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <button type="button" class="btn btn-primary" id="add_teacher">添加指导老师</button>
        </div>
      </div>
      <!-- /block -->
    </div>


  </div>
</div>
<hr>
<footer>
  <p style="text-align:center;">&copy; Team BlueBlueSky_ESTA 2017</p>
</footer>
</div>

<!--弹窗-->
<div class="modal fade" id="mymodal_delete">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">确定删除</h4>
      </div>
      <div class="modal-body" >
        确定删除该学生？<br>
        姓名：<span id="delete_stuName">马哲燚</span><br>
        学号：<span id="delete_stuID">1564424510</span>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
        <button type="button" class="btn btn-primary" id="confirm_delete">确定</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!--弹窗-->
<div class="modal fade" id="mymodal_deleteTeacher">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span></button>
        <h4 class="modal-title">确定删除</h4>
      </div>
      <div class="modal-body" >
        确定删除该指导老师？<br>
        姓名：<span id="delete_teacherName">马哲燚</span><br>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
        <button type="button" class="btn btn-primary" id="confirm_deleteTeacher">确定</button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--/.fluid-container-->


<script src="vendors/jquery-1.9.1.js"></script>
<script src="bootstrap/js/bootstrap.min.js"></script>


<script src="assets/scripts.js"></script>


<script type="text/javascript">

  $("#change_team").click(function(){
     // console.log("你店里");
     location.href = "change/change_team.html";
   });

  $("#add_stu").click(function(){
    location.href = "add/add_stu.html";
  });

  $("#add_teacher").click(function(){
    location.href = "add/add_teacher.html";
  });

  $(".delete_stu").click(function(){
    $("#mymodal_delete").modal("toggle");
    var parentDom = $(this).parent().parent();
    var stu_name = parentDom.children(".stu_name").html();
    var stu_id = parentDom.children(".stu_id").html();

    $("#delete_stuName").html(stu_name);
    $("#delete_stuID").html(stu_id);
      // parentDom.remove();
    });

  $("#confirm_delete").click(function(){
    $("#mymodal_delete").modal("toggle");
    var stu_name = $('#delete_stuName').html();
    var stu_id = $("#delete_stuID").html();
    console.log( stu_id + stu_name);
  });

  $(".delete_teacher").click(function(){
    $("#mymodal_deleteTeacher").modal("toggle");
    var parentDom = $(this).parent().parent();
    var tea_name = parentDom.children('.tea_name').html();
    $('#delete_teacherName').html(tea_name);
  });

  $("#confirm_deleteTeacher").click(function(){
    $("#mymodal_deleteTeacher").modal("toggle");
    var tea_name = $('#delete_teacherName').html();
    console.log(tea_name);
  });

</script>
<script type="text/javascript">

	var teamNum = "201701001";
    //初始化数据ajax请求
    //TEAM = 1;
    //STUDENT = 2;
    //TEACHER = 3;
    for (var i = 0; i < 3; i++) {
      ajaxAction(i, teamNum);
    }
    function ajaxAction(dataType, teamNum) {
	  console.log(teamNum);
    	
      var url;
      if(dataType == 1) {
        url = "/CMD/servlet/GetTeamInfServlet.do";
      } else if(dataType == 2) {
        url = "/CMD/servlet/GetTeamAllMenberInfServlet.do";
      } else if(dataType == 3) {
        url = "";
      }
      $.ajax({    
        type:'post',        
        url: url,    
        data:{  
        	TNO : teamNum
        },   
        cache:false,    
        success:function(data) { 
          if(data == "[]") {
            console.log("没有" + dataType + "的数据");
          } else {
            if(dataType == 1) {
              teamAction(data);
            } else if(dataType == 2) {
              studentAction(data);
            } else if(dataType == 3) {
              teacherAction(data);
            }
          }
        }, 
        error:function() {
          console.log("请求" + dataType + "资料失败");
        } 
      });
    }

    function teamAction(data) {
		//console.log(data);
		var teamObj = eval("(" + data + ")");
		var contactStuID = teamObj.captainsno;
		var competition = teamObj.cno;
		var teamName = teamObj.tna;
		var year = teamObj.year.value;
		var reason = teamObj.reason;
		
		$("#contactName").html("？？");
		$("#contactStuID").html(contactStuID);
		$("#contactTel").html("??");
		$("#contactEmail").html("??");
		$("#competition").html("??");
		$("#teamName").html("??");
    }

    
    
    function studentAction(data) {
		console.log(data);
		var students = eval("(" + data+ ")").stuinf;
		$.each(students, function (index, obj) {
			var email = obj.email;
	        var IDCard = obj.id;
	        var specialty = obj.major;
	        var studentName = obj.sna;
	        var studentID = obj.sno;
	        var tel = obj.tele;
			var isPassed = obj.IsPassed;
			addStudentDom(index+1, studentName, specialty, studentID,
					IDCard, tel, email, isPassed);
	        console.log(email);
		});
    }
    
    function addStudentDom(id, stu_name, stu_specialty, stu_id,
    		stu_idcard, stu_tel, stu_email, stu_state) {
    	var tr = $("<tr></tr>");
    	var td_id = $("<td class='id'>" + id + "</td>");
    	var td_stu_name = $("<td class='stu_name'>" + stu_name + "</td>");
    	var td_stu_specialty = $("<td class='stu_specialty'>" + stu_specialty + "</td>");
    	var td_stu_id = $("<td class='stu_id'>" + stu_id + "</td>");
    	var td_stu_idcard = $("<td class='stu_idcard'>" + stu_idcard + "</td>");
    	var td_stu_tel = $("<td class='stu_tel'>" + stu_tel + "</td>");
    	var td_stu_email = $("<td class='stu_email'>" + stu_email + "</td>");
    	if(stu_state == "0") {
    		stu_state = "未通过";
    	} else {
    		stu_state = "通过";
    	}
    	var td_stu_state = $("<td class='stu_state'>" + stu_state + "</td>");
    	var td_a = $("<td></td>");
    	var a_change = $("<a href='change/change_stu.html'>修改 </a>");
    	var a_delete = $("<a href='javascript:void(0)'  class='delete_stu'>删除</a>");
    	
    	var root = $("#table_stu");
    	root.append(tr);
    	tr.append(td_id);
    	tr.append(td_stu_name);
    	tr.append(td_stu_specialty);
    	tr.append(td_stu_id);
    	tr.append(td_stu_idcard);
    	tr.append(td_stu_tel);
    	tr.append(td_stu_email);
    	tr.append(td_stu_state);
    	tr.append(td_a);
    	td_a.append(a_change);
    	td_a.append(a_delete);
    }
    
    function teacherAction(data) {
		console.log(data);
		var teachers = "";
		$.each(teachers, function(index, obj) {
			
		});
    }
  </script>
</body>
</html>